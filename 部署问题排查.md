# 🔧 部署问题排查指南

## 问题：本地可以，部署后不行

### 可能原因和解决方案

---

## 1. 浏览器缓存问题（最常见）

### 症状：
- 本地正常，部署后显示旧版本
- 功能不正常
- 显示全红色或其他错误

### 解决方案：

**方法1：清除浏览器缓存**
1. 在手机上打开浏览器设置
2. 清除浏览数据/缓存
3. 重新访问网站

**方法2：强制刷新**
- Android Chrome：长按刷新按钮 → "清除缓存并硬性重新加载"
- iPhone Safari：关闭标签页，重新打开

**方法3：使用无痕模式**
- 在无痕模式下访问网站测试

---

## 2. Service Worker缓存问题

### 症状：
- 显示旧版本代码
- 功能异常

### 解决方案：

**清除Service Worker：**
1. 打开浏览器开发者工具（如果可能）
2. Application → Service Workers
3. 点击 "Unregister"
4. 清除缓存
5. 刷新页面

**或者：**
1. 访问网站
2. 按 Ctrl+Shift+Delete（或手机上的清除数据）
3. 选择"缓存的图片和文件"
4. 清除

---

## 3. HTTPS/权限问题

### 症状：
- 相机无法访问
- 显示权限错误

### 检查：
- ✅ GitHub Pages自动提供HTTPS
- ✅ 确保已授予摄像头权限
- ✅ 首次访问时允许权限请求

---

## 4. 文件路径问题

### 检查清单：
- [ ] `manifest.json` 文件存在
- [ ] `service-worker.js` 文件存在
- [ ] `icon-192.png` 和 `icon-512.png` 存在
- [ ] 所有文件都在仓库根目录

### 验证方法：
访问以下URL，应该能正常访问：
- `https://zy593.github.io/xiangji/manifest.json`
- `https://zy593.github.io/xiangji/service-worker.js`
- `https://zy593.github.io/xiangji/icon-192.png`

---

## 5. 代码更新未生效

### 检查：
1. 确认代码已推送到GitHub
2. 等待GitHub Pages部署完成（1-2分钟）
3. 检查仓库文件是否最新

### 验证部署：
访问：https://github.com/zy593/xiangji
查看文件是否是最新版本

---

## 6. 移动端特定问题

### 症状：
- 桌面浏览器正常，手机不正常
- 显示全红色

### 可能原因：
- 视频元数据加载问题
- Canvas尺寸问题
- 移动端浏览器兼容性

### 已修复：
- ✅ 添加了视频元数据等待
- ✅ 改进了Canvas尺寸检查
- ✅ 添加了错误处理

---

## 🔍 快速排查步骤

### 第一步：检查网站是否可访问
访问：`https://zy593.github.io/xiangji/`
- 如果404：检查GitHub Pages是否启用
- 如果显示：继续下一步

### 第二步：清除缓存
1. 清除浏览器缓存
2. 清除Service Worker
3. 强制刷新

### 第三步：检查控制台错误
1. 在电脑上打开网站
2. 按F12打开开发者工具
3. 查看Console标签
4. 查看是否有错误信息

### 第四步：验证文件
访问以下URL确认文件存在：
- `https://zy593.github.io/xiangji/manifest.json`
- `https://zy593.github.io/xiangji/service-worker.js`

### 第五步：重新部署
1. 确保代码已更新
2. 推送到GitHub
3. 等待部署完成
4. 清除缓存后重试

---

## 💡 推荐操作

### 立即尝试：
1. **清除手机浏览器缓存**
2. **关闭并重新打开浏览器**
3. **重新访问网站**
4. **授予摄像头权限**

### 如果还不行：
1. **检查GitHub仓库文件是否最新**
2. **等待几分钟让GitHub Pages更新**
3. **使用无痕模式测试**
4. **检查浏览器控制台错误**

---

## 📞 需要更多帮助？

如果问题仍然存在：
1. 检查浏览器控制台的错误信息
2. 确认GitHub Pages部署状态
3. 验证所有文件都已上传
4. 尝试不同的浏览器测试

---

**记住：清除缓存是解决部署问题的最常见方法！** 🔄

